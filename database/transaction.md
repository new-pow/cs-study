# íŠ¸ëœì­ì…˜ Transaction

### íŠ¸ëœì­ì…˜(Transaction)ì´ë€?

> ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¤ê¸° ìœ„í•´ ìˆ˜í–‰í•˜ëŠ” ì‘ì—… ë‹¨ìœ„

ğŸ’¡ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¨ë‹¤ëŠ” ê²ƒì„ ë¬´ì—‡ì¼ê¹Œ?

â†’ SQL ì§ˆì˜ì–´ë¥¼ í†µí•´ DBì— ì ‘ê·¼í•˜ëŠ” ê²ƒ!Â 

â€» SQL ì§ˆì˜ì–´

-   SELECT
-   INSERT
-   DELETE
-   UPDATE

ğŸš¨ ì‘ì—…ì˜ ë‹¨ìœ„ëŠ” ì§ˆì˜ì–´ í•œë¬¸ì¥ì´ ì•„ë‹ˆë‹¤.

ì‘ì—…ë‹¨ìœ„ : ë§ì€ ì§ˆì˜ì–´ ëª…ë ¹ë¬¸ë“¤ì„ ì‚¬ëŒì´ ì •í•˜ëŠ” ê¸°ì¤€ì— ë”°ë¼ ì •í•˜ëŠ” ê²ƒì„ ì˜ë¯¸.

> ì˜ˆì‹œ) ì‚¬ìš©ì Aê°€ ì‚¬ìš©ì Bì—ê²Œ 10,000ì›ì„ ì†¡ê¸ˆí•œë‹¤.  
>   
> âœ”ï¸ ì´ë•Œ DB ì‘ì—…  
> 1\. ì‚¬ìš©ì Aì˜ ê³„ì¢Œì—ì„œ ë§Œì›ì„ ì°¨ê°í•œë‹¤ : UPDATEë¬¸ì„ ì‚¬ìš©í•´ ì‚¬ìš©ì Aì˜ ì”ê³ ë¥¼ ë³€ê²½  
> 2\. ì‚¬ìš©ì Bì˜ ê³„ì¢Œì—ì„œ ë§Œì›ì„ ì¶”ê°€í•œë‹¤ : UPDATEë¬¸ì„ ì‚¬ìš©í•´ ì‚¬ìš©ì Bì˜ ì”ê³ ë¥¼ ë³€ê²½  
>   
> ğŸ’¡ í˜„ì¬ ì‘ì—… ë‹¨ìœ„ : ì¶œê¸ˆ UPDATEë¬¸ + ì…ê¸ˆ UPDATEë¬¸  
> â†’ ì´ë¥¼ í†µí‹€ì–´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ë¼ê³  í•œë‹¤.  
>   
> \- ìœ„ ë‘ ì¿¼ë¦¬ë¬¸ ëª¨ë‘ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì–´ì•¼ë§Œ  
> "í•˜ë‚˜ì˜ ì‘ì—…(íŠ¸ëœì­ì…˜)"ì´ **ì™„ë£Œ**ë˜ëŠ” ê²ƒì´ë‹¤. : commit  
> \- ì‘ì—… ë‹¨ìœ„ì— ì†í•˜ëŠ” ì¿¼ë¦¬ ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´Â   
> ëª¨ë“  ì¿¼ë¦¬ë¬¸ì„ ì·¨ì†Œí•˜ê³  **ì´ì „ ìƒíƒœë¡œ ëŒë ¤ë†“ì•„ì•¼** í•œë‹¤. : Rollback

ì¦‰, í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ì„¤ê³„ë¥¼ ì˜ ë§Œë“œëŠ” ê²ƒì´ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ë§ì€ ì´ì ì„ ê°€ì ¸ë‹¤ì¤€ë‹¤.

---

## íŠ¸ëœì­ì…˜ì˜ íŠ¹ì§• (ACID)

#### ì›ìì„± (Atomicity)

> íŠ¸ëœì­ì…˜(ì‘ì—…)ì´ ëª¨ë‘ ë°˜ì˜ë˜ë˜ì§€, ì•„ë‹ˆë©´ ì „í˜€ ë°˜ì˜ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.  
> ì¦‰, **All or Nothing**

#### ì¼ê´€ì„± (Consistency)

> íŠ¸ëœì­ì…˜ì˜ ì‘ì—… ì²˜ë¦¬ ê²°ê³¼ëŠ” í•­ìƒ ì¼ê´€ì„±ì´ ìˆì–´ì•¼ í•œë‹¤.

#### ë…ë¦½ì„± (Isolation)

> ë‘˜ ì´ìƒì˜ íŠ¸ëœì­ì…˜ì´ ë™ì‹œì— ë³‘í–‰ ì‹¤í–‰ë˜ê³  ìˆì„ ë•Œ,Â   
> ì„œë¡œì˜ ì—°ì‚°ì— ë¼ì–´ë“¤ ìˆ˜ ì—†ë‹¤.

#### ì§€ì†ì„± (Durability)

> íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìœ¼ë©´, ê²°ê³¼ëŠ” ì˜êµ¬ì ìœ¼ë¡œ ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤.  
> ì¦‰, ì™„ë£Œëœ ê²°ê³¼ëŠ” ì˜êµ¬ì ìœ¼ë¡œ ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤.

---

## íŠ¸ëœì­ì…˜ì˜ Commit, Rollback ì—°ì‚°

#### Commit

> í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ëë‚¬ê³ , DBê°€ ì¼ê´€ì„±ìˆëŠ” ìƒíƒœì¼ ë•ŒÂ   
> ì´ë¥¼ ì•Œë ¤ì£¼ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°.

#### Rollback

> í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì–´ íŠ¸ëœì­ì…˜ ì›ìì„±ì´ ê¹¨ì§„ ê²½ìš°,Â   
> íŠ¸ëœì­ì…˜ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ê±°ë‚˜,Â   
> íŠ¸ëœì­ì…˜ì˜ ë¶€ë¶„ì ìœ¼ë¡œë§Œ ì—°ì‚°ëœ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ì·¨ì†Œì‹œí‚¤ì•‹.

> ğŸ’¡ ì¦‰, í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì€ Commit(ì‘ì—…ì™„ë£Œ)ë˜ê±°ë‚˜ Rollback(ì·¨ì†Œ)ëœë‹¤.

---

### íŠ¸ëœì­ì…˜ì˜ 5ê°€ì§€ ìƒíƒœ

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdShbhc%2FbtrV0QVfkcW%2F0oP4tdpAF0swz22rPikDF1%2Fimg.jpg)

-   **í™œë™(Active)** : íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ì¤‘ì¸ ìƒíƒœ
-   **ì‹¤íŒ¨(Failed) :**Â íŠ¸ëœì­ì…˜ ì‹¤í–‰ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ ì¤‘ë‹¨ëœ ìƒíƒœ
-   **ì² íšŒ(Aborted) :**Â íŠ¸ëœì­ì…˜ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì–´ Rollback ì—°ì‚°ì„ ìˆ˜í–‰í•œ ìƒíƒœ
-   **ë¶€ë¶„ ì™„ë£Œ(Partially Committed) :**Â íŠ¸ëœì­ì…˜ì˜ ë§ˆì§€ë§‰ ì—°ì‚°ê¹Œì§€ ì‹¤í–‰í–ˆì§€ë§Œ, Commit ì—°ì‚°ì´ ì‹¤í–‰ë˜ê¸° ì§ì „ì˜ ìƒíƒœ
-   **ì™„ë£Œ(Committed) :**Â íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì¢…ë£Œë˜ì–´ Commit ì—°ì‚°ì„ ì‹¤í–‰í•œ í›„ì˜ ìƒíƒœ

---

### ì¶œì²˜

-   [https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Database/Transaction.md](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Database/Transaction.md)
-   [https://github.com/JaeYeopHan/Interview\_Question\_for\_Beginner/tree/master/Database#transaction](https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/Database#transaction)
-   [https://dev-coco.tistory.com/158?category=1056309](https://dev-coco.tistory.com/158?category=1056309)
-   [https://mommoo.tistory.com/62](https://mommoo.tistory.com/62)
-   [https://wonit.tistory.com/462](https://wonit.tistory.com/462)
-   [https://coding-factory.tistory.com/226](https://coding-factory.tistory.com/226)

---

<br>
<br>

-   íŠ¸ëœì­ì…˜ì€ í•˜ë‚˜ì˜ ì‘ì—… ë‹¨ìœ„ë¥¼ ëœ»í•œë‹¤.

```
// ì˜ˆì‹œ

"ìƒí’ˆ ë°œì†¡"ì´ë¼ëŠ” íŠ¸ëœì­ì…˜ì˜ ì‘ì—…ë“¤
1. í¬ì¥
2. ì˜ìˆ˜ì¦ ë°œí–‰
3. ë°œì†¡
```

-   íŠ¸ëœì­ì…˜ì„ ì´ë£¨ëŠ” ì‘ì—…ë“¤ ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ 3ê°€ì§€ ëª¨ë‘ ì·¨ì†Œí•˜ê³  â€œìƒí’ˆ ë°œì†¡â€ ì´ì „ì˜ ìƒíƒœë¡œ ëŒë ¤ì•¼ í•œë‹¤. == ë¡¤ë°±Rollback
-   íŠ¸ëœì­ì…˜ì€ ì˜ˆì™¸ì²˜ë¦¬ì™€ ê´€ë ¨ì´ ê¹Šë‹¤.

```java
ìƒí’ˆë°œì†¡() {
    **try {**
        í¬ì¥();
        ì˜ìˆ˜ì¦ë°œí–‰();
        ë°œì†¡();
    **}catch(ì˜ˆì™¸) {**
        ëª¨ë‘ì·¨ì†Œ();  // í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ëª¨ë‘ ì·¨ì†Œ
    **}**
}

í¬ì¥() **throws ì˜ˆì™¸** {
   ...
}

ì˜ìˆ˜ì¦ë°œí–‰() **throws ì˜ˆì™¸** {
   ...
}

ë°œì†¡() **throws ì˜ˆì™¸** {
   ...
}
```

-   ë§Œì•½ ë©”ì„œë“œì— ê°ê° ì˜ˆì™¸ ì²˜ë¦¬ê°€ ë˜ì–´ìˆë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ? ìƒê°í•´ë³´ì.

---

-   ì°¸ê³ 
    -   [ì í”„ íˆ¬ ìë°”](https://wikidocs.net/229)
- log
	- `22.12.31` Error & Exception ì •ë¦¬í•˜ë©° ê´€ë ¨ ë‚´ìš© ì •ë¦¬